<!DOCTYPE html>
<html lang=zh-CN class="bg-gray-100">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:type" content="website">

<meta name="description" content="吹雨听风独立博客">
<meta property="og:description" content="吹雨听风独立博客">


<meta name="keyword"  content="">

<link rel="shortcut icon" href="/img/favicon.ico">

<link rel="stylesheet" href="/css/tailwind.css">


<link rel="stylesheet" href="/css/typo.css">


<link rel="stylesheet" href="/css/theme.css">

<script type="text/javascript" src="/js/theme.js?v="></script>
<title>
    
        Web 前端直接渲染 Office 格式文档的几种方案 - 吹雨听风
    
</title>    

<body>

<div class="index-container py-2 md:py-8 px-2 md:px-0">
    <div class="main-content-wrapper max-w-4xl m-auto bg-white pt-8 pb-6 px-10">
        <header class="">
    <div class="max-w-4xl mx-auto">
        <div class="py-4 border-b border-slate-900/10 border-0 dark:border-slate-300/10 mx-0">
            <div class="relative sm:flex sm:items-center">
                <div class="flex-none sm:flex-initial">
                    <a class="flex-none overflow-hidden md:w-auto" href="/.">
                        <span class="text-xl font-bold">吹雨听风</span>
                    </a>

                    
                        <span class="hidden md:inline-block text-xs text-gray-500"><i> - 热爱写代码. </i></span>
                    
                </div>

                <div class="flex-none sm:flex-auto flex items-center sm:justify-end lg:w-0 space-x-4">
    

    

    

    

    
</div>
            </div>
        </div>
    </div>
</header>

        
        

        <main>
            
<article class="max-w-4xl mx-auto py-10 typo">
    <h1 style="margin-top: 0;">
        Web 前端直接渲染 Office 格式文档的几种方案
    </h1>

    <div>
        <div class="flex">
                <span>
                    <time datetime="Mon May 30 2022 00:00:00 GMT+0000">2022-05-30</time>
                </span>

            

            
        </div>

        
    <div class="mt-2">
        <span>标签：</span>
        
            <a class="" href="/tags/#技术"
               title="技术">技术</a>
            
                <span>,</span>
            
        
            <a class="" href="/tags/#前端"
               title="前端">前端</a>
            
        
    </div>

    </div>

    <section class="pt-10 ">
        <p>在一些中台系统中或管理后台系统中，在线预览 Office 文档是个比较常见的需求，奈何浏览器的支持有限在做相关功能时踩了一些坑。</p>
<h2 id="通用解决方案"><a href="#通用解决方案" class="headerlink" title="通用解决方案"></a>通用解决方案</h2><h3 id="通过-PDF-格式预览"><a href="#通过-PDF-格式预览" class="headerlink" title="通过 PDF 格式预览"></a>通过 PDF 格式预览</h3><p>现在注流的浏览器已经支持了 PDF 文件的在线预览，但是对于 word &#x2F; excel 等格式文件，浏览器的还没有提供直接的支持。应此在需要预览 word 或 excel 文件时，可以考虑先将其转换为 PDF 文件，再通过浏览器的能力渲染。</p>
<p>渲染 PDF 文件非常简单，比较常见的有下面 2 种方式：</p>
<ul>
<li>链接</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Open a PDF file <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/uploads/media/example.pdf&quot;</span>&gt;</span>example<span class="tag">&lt;/<span class="name">a</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>点击链接，浏览器会新一个 Tab 来打开 PDF 文件进行预览。</p>
<ul>
<li>在 html 中通过 iframe 来渲染</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">src</span>=<span class="string">&quot;/uploads/media/example.pdf&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">height</span>=<span class="string">&quot;500px&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2 种方式都是基于浏览器内置能力实现，有点和缺点也都比较明显：</p>
<ul>
<li>优点：自带“打印”，“搜索”，“翻页”等功能，强大且实现非常简单方便</li>
<li>缺点：不同浏览器的pdf工具样式不一，且无法满足个性化需求，比如：禁止打印，下载等</li>
</ul>
<h3 id="PDF-js"><a href="#PDF-js" class="headerlink" title="PDF.js"></a>PDF.js</h3><p><a target="_blank" rel="noopener" href="https://mozilla.github.io/pdf.js">PDF.js</a> 由 mozilla 开发并使用 apache 许可开源发布的工具库。其基于HTML5技术构建，用于展示可移植文档格式的文件(PDF)，它可以在现代浏览器中使用且无需安装任何第三方插件。简单的 demo 如下，详细使用方法可参考项目官网。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">&quot;pdf-canvas&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br><span class="line"></span><br><span class="line">var url = &#x27;Helloworld.pdf&#x27;;</span><br><span class="line"></span><br><span class="line">PDFJS.getDocument(url).then((pdf) =&gt; &#123;</span><br><span class="line">    return pdf.getPage(1);</span><br><span class="line">&#125;).then((page) =&gt; &#123;</span><br><span class="line">    // 设置展示比例</span><br><span class="line">    var scale = 1.5;</span><br><span class="line">    // 获取pdf尺寸</span><br><span class="line">    var viewport = page.getViewport(scale);</span><br><span class="line">    // 获取需要渲染的元素</span><br><span class="line">    var canvas = document.getElementById(&#x27;pdf-canvas&#x27;);</span><br><span class="line">    var context = canvas.getContext(&#x27;2d&#x27;);</span><br><span class="line">    canvas.height = viewport.height;</span><br><span class="line">    canvas.width = viewport.width;</span><br><span class="line">    </span><br><span class="line">    var renderContext = &#123;</span><br><span class="line">        canvasContext: context,</span><br><span class="line">        viewport: viewport</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    page.render(renderContext);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="通过在线预览服务"><a href="#通过在线预览服务" class="headerlink" title="通过在线预览服务"></a>通过在线预览服务</h3><p>微软和 Google 都提供了免费的文档在线预览服务，通过该服务我们可以非常方便的实便在 web 中预览文件，但是这种方式的缺点在于，文档必需为公网可访问，否则无法预览。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 微软 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">src</span>=<span class="string">&#x27;https://view.officeapps.live.com/op/view.aspx?src=http://a.com/b.xls&#x27;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">width</span>=<span class="string">&#x27;100%&#x27;</span> <span class="attr">height</span>=<span class="string">&#x27;100%&#x27;</span> <span class="attr">frameborder</span>=<span class="string">&#x27;1&#x27;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Google --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">:src</span>=<span class="string">&quot;&#x27;https://docs.google.com/viewer?url=&quot;</span><span class="attr">fileurl</span>&quot;&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>除了在公网使用微软服务，或将 word 或 excel 文件转为 PDF 外，还有没有其它的方式呢？</p>
<h2 id="sheet-js"><a href="#sheet-js" class="headerlink" title="sheet.js"></a>sheet.js</h2><p><a target="_blank" rel="noopener" href="https://github.com/SheetJS/sheetjs">SheetJS</a> 和 pdf.js 类似，基于现在流行的 HTML5 技术构建，可以直接在	web 页面中通过 js 或 ts 渲染表格。</p>
<h2 id="word-文件"><a href="#word-文件" class="headerlink" title="word 文件"></a>word 文件</h2><p>目前对于 word 文件还是无能为力。</p>
<h2 id="商业服务"><a href="#商业服务" class="headerlink" title="商业服务"></a>商业服务</h2><p>在企业市场，将文档转为共网可访问的文件，显然是不行的，因此催生了众多的商业服务为企业提供相关的解决方案。这里列举几个常见的平台：</p>
<ul>
<li>XDOC文档预览云服务 <a target="_blank" rel="noopener" href="https://view.xdocin.com/">https://view.xdocin.com/</a>    支持私有化</li>
<li>永中 <a target="_blank" rel="noopener" href="https://www.yozodcs.com/">https://www.yozodcs.com/</a>   支持私有化</li>
<li>IDOC <a target="_blank" rel="noopener" href="https://www.idocv.com/docs.html">https://www.idocv.com/docs.html</a>  支持私有化</li>
<li>文档服务 DOC <a target="_blank" rel="noopener" href="https://cloud.baidu.com/product/doc.html?track=cp:nsem%7Cpf:pc%7Cpp:doc%7Cpu:long%7Cci:%7Ckw:118945">https://cloud.baidu.com/product/doc.html?track=cp:nsem|pf:pc|pp:doc|pu:long|ci:|kw:118945</a></li>
<li>Wps <a target="_blank" rel="noopener" href="https://wwo.wps.cn/docs/introduce/">https://wwo.wps.cn/docs/introduce/</a></li>
</ul>
<p>总结一下，对于可公开的文档，基于微软的在线预览服务，简单便捷。对于不可公开的文档，可以考虑将其转换为通用的 PDF 格式。如果有更多的要求，可以购买相关的服务。</p>

    </section>
</article>
        </main>

        <footer class="max-w-4xl mx-auto py-2 border-t border-solid border-gray-100 text-xs pb-5">
    <div class="sm:flex space-y-2 sm:space-y-0">
        <div class="sm:flex-initial">
            
            &copy;
            
                2018 -
            
            2025

            <span>吹雨听风.</span>

            <span>
                本站由 <a class="hexo-link " target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> and
                <a target="_blank" rel="noopener" href="https://github.com/cmzz/hexo-theme-snow-white">Snow White</a>
                
                    强力驱动
                
            </span>
        </div>

        <div class="flex sm:flex-initial items-center">
            

            

            

            
                <span class="inline-block px-2 text-xs text-gray-400 hidden sm:inline-block">|</span>
                <span>
                    <a href="/links"
                       class="whitespace-nowrap text-gray-500 "> 链接 </a>
                </span>
            

            
                <span class="inline-block px-2 text-xs text-gray-400 hidden sm:inline-block">|</span>
                <span>
                    <a href="/atom.xml" title="RSS" target="_blank" rel="noopener">RSS</a>
                </span>
            

            
                <span class="inline-block px-2 text-xs text-gray-400 hidden sm:inline-block">|</span>
                <span>
                    <a href="/sitemap.xml" title="网站地图" target="_blank" rel="noopener">网站地图</a>
                </span>
            
        </div>
    </div>

    <div class="mt-2">
        <a href="https://creativecommons.org/licenses/by-nc/4.0/deed.zh" title="署名-非商业性使用 4.0 国际 (CC BY-NC 4.0)" target="_blank" rel="noopener">署名-非商业性使用 4.0 国际 (CC BY-NC 4.0)</a>
    </div>
</footer>




    </div>
</div>

</body>
</html>